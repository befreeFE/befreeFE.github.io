
<script>
export default {
  data() {
    return {
      num: 0,
      bindNum: 0
    }
  },
  methods: {
    getSingle(fn) {
      let result;
      return function() {
        return result || (result = fn.apply(this, arguments));
      }
    },
    bindEvent() {
      this.$refs.btn.addEventListener('click', () => {
        this.num++
      })
    },
    bind() {
      this.bindNum++
      this.bindEvent();
    }
  },
  mounted() {
  }
}
</script>
## 单例模式

单例模式的定义是：保证一个类仅有一个实例，并提供一个访问它的全局访问点。应用场景不限于创建单个实例。对于VUE单文件来说，推荐字面量的形式创建对象，而不是传统的基于New的面向对象方式创建。

## 事件绑定例子

### 1、未使用单例

结果导致元素绑定重事件，增大性能开销。(首先点击执行绑定多次，后点击被绑定元素)


::: demo 不使用单例模式的情况下绑定事件将导致元素被绑定多个重复事件。

```html
<template>
  <div>
    <el-button type="primary" @click="bind">
      执行绑定 {{bindNum}}
    </el-button>

    <span ref="btn" class="btn">
      被绑定元素
    </span>
    事件处理次数:{{num}}
</template>
<script>
export default {
  data() {
    return {
      num: 0,
      bindNum: 0
    }
  },
  methods: {
    getSingle(fn) {
      let result;
      return function() {
        return result || (result = fn.apply(this, arguments));
      }
    },
    bindEvent() {
      this.$refs.btn.addEventListener('click', () => {
        this.num++
      })
    },
    bind() {
      this.bindNum++
      this.bindEvent();
    }
  },
  mounted() {
  }
}
</script>
<style>
.btn {
  display: inline-block;
  line-height: 1;
  white-space: nowrap;
  cursor: pointer;
  background: #fff;
  border: 1px solid #c4c4c4;
  color: #1f2d3d;
  margin: 0;
  padding: 10px 15px;
  border-radius: 4px;
}
</style>

```

:::

### 2、使用单例

首先点击执行绑定多次，后点击被绑定元素

::: demo 使用单例模式

```html
<template>
  <div>
    <el-button type="primary" @click="bind2">
      执行绑定 {{bindNum2}}
    </el-button>

    <span ref="btn" class="btn">
      被绑定元素
    </span>
    事件处理次数:{{num2}}
</template>
<script>
export default {
  data() {
    return {
      num2: 0,
      bindNum2: 0
    }
  },
  methods: {
    getSingle2(fn) {
      let result;
      return function() {
        return result || (result = fn.apply(this, arguments));
      }
    },
    bindEvent2() {
      this.getSingle2(
        this.$refs.btn.addEventListener('click', () => {
          this.num++
        })
      )
    },
    bind2() {
      this.bindNum++
      this.bindEvent2();
    }
  },
  mounted2() {
  }
}
</script>
<style>
.btn {
  display: inline-block;
  line-height: 1;
  white-space: nowrap;
  cursor: pointer;
  background: #fff;
  border: 1px solid #c4c4c4;
  color: #1f2d3d;
  margin: 0;
  padding: 10px 15px;
  border-radius: 4px;
}
</style>

```

:::



<style>
.demo-box .el-alert {
  margin: 20px 0 0;
}

.demo-box .el-alert:first-child {
  margin: 0;
  color: #000;
}
</style>
